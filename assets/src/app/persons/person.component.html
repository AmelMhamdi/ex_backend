<h1>
  Person
</h1>

<div class="person">
  <div *ngIf=!creation class="step-content">
    <person-form-component [person]=person (change)="updated = true"></person-form-component>
    <div>
      <button mat-raised-button
        (click)="cancel()">
        <i class="material-icons">cancel</i>
        Cancel
      </button>
      <button mat-raised-button
        color="primary"
        [disabled]=!updated
        (click)="updatePerson()">
        <i class="material-icons">done</i>
        Update
      </button>
    </div>
  </div>

  <div *ngIf="creation">
    <mat-horizontal-stepper>
      <ng-template matStepperIcon="edit" let-index="index">
        <div *ngIf="index>0">{{index + 1}}</div>
        <mat-icon *ngIf="index==0">done</mat-icon>
      </ng-template>

      <mat-step label="Import from link">
        <div class="step-content">
          <link-import-component (onUrlSet)="setPeopleInfoLink($event)"></link-import-component>
          <div>
            <button mat-raised-button
              (click)="cancel()">
              <i class="material-icons">cancel</i>
              Cancel
            </button>
            <button mat-raised-button
              *ngIf="peopleInfoLink && peopleInfoLink.url.length > 0"
              matStepperNext
              color="accent"
              (click)="getPeopleInfo()"
              >Next
              <i class="material-icons">navigate_next</i>
            </button>
            <button mat-raised-button
              *ngIf="!peopleInfoLink || peopleInfoLink.url.length == 0"
              matStepperNext
              color="primary"
              >Skip
              <i class="material-icons">navigate_next</i>
            </button>
          </div>
        </div>
      </mat-step>
      <mat-step label="Complete information">
        <div class="step-content">
          <mat-spinner *ngIf=gettingPeopleInfo class="spinner" [color]="accent"></mat-spinner>
          <div *ngIf=!gettingPeopleInfo>
            <person-form-component [person]=person (change)="setPerson($event)"></person-form-component>
            <div>
              <button mat-raised-button
                (click)="cancel()">
                <i class="material-icons">cancel</i>
                Cancel
              </button>
              <button mat-raised-button
                matStepperPrevious>
                <i class="material-icons">navigate_before</i>
                Back
              </button>
              <button mat-raised-button
                (click)="createPerson()"
                color="accent"
                [disabled]=!filled>
                + Add person
              </button>
            </div>
          </div>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </div>

  <div>
    <span class=message
      *ngIf="error_message">
      {{error_message}}
    </span>
  </div>

</div>
